Title: Cable modems: Arris SB6190 vs. Netgear CM600
Date: 2016-08-06T21:52Z
Summary: Two DOCSIS 3.0 cable modems compared.

Recently I activated new cable ISP service at my home and needed to purchase a
cable modem. There were only a few candidate devices that supported at least 24
downstream channels (preferably 32), and did not contain an integrated router or
access point.

The first modem I tried was the [Arris SB6190], which supports 32 downstream
channels. It is based on the [Intel Puma 6] SoC, and looking at an older release
of the [SB6190 firmware source] reveals that the device runs Linux. This device,
running the latest 9.1.93N firmware, goes into a failure mode after several days
of uptime which causes it to drop 1-2% of packets. Here is a [SmokePing] graph
that measures latency to my ISP's recursive DNS server, showing the transition
into the “degraded” mode:

![SmokePing Arris SB6190 Firmware 9.1.93N]({attach}images/SmokePing_Arris_SB6190_Firmware_9.1.93N.png)

It didn't drop packets at random, though. Some traffic would be
deterministically dropped, such as the parallel A/AAAA DNS lookups generated by
the glibc DNS stub resolver. For instance, in the following `tcpdump` output:

``` .boxed
[1] 17:31:46.989073 IP [My IP].50775 > 75.75.75.75.53: 53571+ A? www.comcast6.net. (34)
[2] 17:31:46.989102 IP [My IP].50775 > 75.75.75.75.53: 14987+ AAAA? www.comcast6.net. (34)
[3] 17:31:47.020423 IP 75.75.75.75.53 > [My IP].50775: 53571 2/0/0 CNAME comcast6.g.comcast.net., […]
[4] 17:31:51.993680 IP [My IP].50775 > 75.75.75.75.53: 53571+ A? www.comcast6.net. (34)
[5] 17:31:52.025138 IP 75.75.75.75.53 > [My IP].50775: 53571 2/0/0 CNAME comcast6.g.comcast.net., […]
[6] 17:31:52.025282 IP [My IP].50775 > 75.75.75.75.53: 14987+ AAAA? www.comcast6.net. (34)
[7] 17:31:52.056550 IP 75.75.75.75.53 > [My IP].50775: 14987 2/0/0 CNAME comcast6.g.comcast.net., […]
```

Packets `[1]` and `[2]` are the A and AAAA queries being initiated in parallel.
Note that they both use the same 4-tuple of _(Source IP, Destination IP, Source
Port, Destination Port)_, but with different DNS IDs. Packet `[3]` is the
response to packet `[1]`. The response to packet `[2]` never arrives, and five
seconds later, the glibc stub resolver times out and retries in `single-request`
mode, which performs the A and AAAA queries sequentially. Packets `[4]` and
`[5]` are the type A query and response, and packets `[6]` and `[7]` are the
AAAA query and response.

The Arris SB6190 running firmware 9.1.93N would consistently interfere with
these parallel DNS requests, but only when operating in its “degraded” mode. It
also didn't matter whether glibc was configured to use an IPv4 or IPv6
nameserver, or which nameserver was being used. Power cycling the modem would
fix the issue for a few days.

My ISP offered to downgrade the firmware on the Arris SB6190 to version 9.1.93K.
This firmware version doesn't go into a degraded mode after a few days, but it
does exhibit higher latency, and more jitter:

![SmokePing Arris SB6190 Firmware 9.1.93K]({attach}images/SmokePing_Arris_SB6190_Firmware_9.1.93K.png)

It seemed unlikely that Arris would fix the firmware issues in the SB6190 before
the end of my 30-day return window, so I returned the SB6190 and purchased a
[Netgear CM600]. This modem appears to be based on the [Broadcom BCM3384] and
looking at an older release of the [CM600 firmware source] reveals that the
device runs the open source [eCos] embedded operating system.

The Netgear CM600 so far hasn't exhibited any of the issues I found with the
Arris SB6190 modem. Here is a SmokePing graph for the CM600, which shows median
latency about 1 ms lower than the Arris modem:

![SmokePing Netgear CM600]({attach}images/SmokePing_Netgear_CM600.png)

It's not clear which company is to blame for the problems in the Arris modem.
Looking at the DOCSIS drivers in the SB6190 firmware source reveals copyright
statements from ARRIS Group, Texas Instruments, and Intel. However, I would
recommend avoiding cable modems produced by Arris in particular, and cable
modems based on the Intel Puma SoC in general.

[Arris SB6190]:           http://mydeviceinfo.xfinity.com/device.php?devid=461
[Intel Puma 6]:           http://www.intel.com/content/www/us/en/connected-home/ibc-puma-6-32-channel-tech-brief.html
[SB6190 firmware source]: https://sourceforge.net/projects/sb6190.arris/files/
[SmokePing]:              http://oss.oetiker.ch/smokeping/
[Netgear CM600]:          http://mydeviceinfo.xfinity.com/device.php?devid=455
[Broadcom BCM3384]:       http://www.broadcom.com/products/Cable/Cable-Modem-Solutions/BCM3384
[CM600 firmware source]:  http://kb.netgear.com/app/answers/detail/a_id/2649/~/netgear-open-source-code-for-programmers-(gpl)
[eCos]:                   https://en.wikipedia.org/wiki/ECos
